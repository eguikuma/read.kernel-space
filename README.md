<div align="right">
<img src="https://img.shields.io/badge/AI-ASSISTED_STUDY-3b82f6?style=for-the-badge&labelColor=1e293b&logo=bookstack&logoColor=white" alt="AI Assisted Study" />
</div>

# read.kernel-space

<strong>「OS 自身がどう動いているか」</strong>を、説明モデルとして学びます

---

## このリポジトリは何のためにあるのか

前のシリーズでは、「OS がプログラムを動かす仕組み」を<strong>使う側</strong>の視点で学びました

- プロセスとは何か
- fork/exec でプロセスを作る方法
- シグナルでプロセスに通知する方法
- スレッドで並行処理する方法
- ファイルディスクリプタで OS がファイルを管理する仕組み
- 標準入出力の仕組み
- プロセス間通信の方法

これらはすべて「ユーザー空間」で動くプログラムの話でした

では、プログラムが fork() を呼んだとき、OS の中では何が起きているのでしょうか？

メモリを確保するとき、なぜ他のプロセスのメモリに干渉しないのでしょうか？

このリポジトリでは、その「裏側」を学びます

---

## このリポジトリの特徴

### <strong>カーネルソースは読まない</strong>

Linux カーネルのソースコードは非常に複雑で、初学者が読み解くのは困難です

このリポジトリでは、カーネルの動作を「観察」することで理解します

### <strong>観察の手段</strong>

カーネルの動作を観察するために、以下の手段を使います

- <strong>/proc ファイルシステム</strong>
  - カーネルがプロセスやシステムの情報を公開する疑似ファイルシステムです
  - 例：`/proc/meminfo` でメモリの使用状況を確認できます
- <strong>/sys ファイルシステム</strong>
  - カーネルがデバイスやサブシステムの情報を公開する疑似ファイルシステムです
  - 例：`/sys/fs/cgroup` でコントロールグループの設定を確認できます
- <strong>システムコール</strong>
  - ユーザー空間からカーネルに処理を依頼する仕組みです
  - 例：uname() でカーネルのバージョンを取得できます

### <strong>説明モデルとして理解する</strong>

「カーネル内部で実際にどう実装されているか」ではなく、「カーネルは何をしていると考えればよいか」を学びます

---

## 「カーネル空間」とは何か

コンピュータの世界には、大きく分けて2つの「空間」があります

### <strong>1. ユーザー空間（User Space）</strong>

私たちが普段使うプログラム（アプリ）が動いている場所です

前のシリーズで学んだ内容は、すべてここに関するものでした

### <strong>2. カーネル空間（Kernel Space）</strong>

OS の心臓部が動いている場所です

ハードウェア（CPU、メモリ、ディスクなど）を直接操作できます

一般のプログラムはここに直接触れることができません

このリポジトリでは、<strong>カーネル空間</strong>に焦点を当てます

---

## なぜこれを学ぶのか

### <strong>1. ブラックボックスを開く</strong>

前のシリーズで学んだシステムコールは、「カーネルに何かを頼む」ものでした

でも、カーネルが実際に何をしているかは見えませんでした

このリポジトリでは、その「見えない部分」を理解します

### <strong>2. コンテナ技術の基盤を理解する</strong>

Docker や Kubernetes などの<strong>コンテナ技術</strong>（1 台のサーバーで複数のアプリを隔離して動かす技術）は、カーネルの機能を使って実現されています

- <strong>namespace</strong>：プロセスを隔離する仕組み
- <strong>cgroup</strong>：リソースを制限する仕組み

これらを理解することで、「コンテナとは何か」が本質的にわかるようになります

### <strong>3. トラブルシューティングの基礎</strong>

システムの問題を解決するとき、カーネルの動作を理解していると原因を特定しやすくなります

例えば、「プロセスが遅い」という問題に対して

- スケジューラがどう CPU 時間を配分しているか
- メモリがどう管理されているか
- プロセスがどの状態にあるか

を確認できるようになります

---

## このリポジトリで学ぶこと

| 順番 | トピック                                         | 学ぶこと                                            |
| ---- | ------------------------------------------------ | --------------------------------------------------- |
| 01   | [kernel](./01-kernel.md)                         | カーネルの役割、/proc と /sys で情報を観察する方法  |
| 02   | [syscall](./02-syscall.md)                       | システムコールの仕組み、strace による観察           |
| 03   | [virtual-memory](./03-virtual-memory.md)         | 仮想メモリ、ページング、mmap によるメモリマッピング |
| 04   | [process-management](./04-process-management.md) | プロセスの状態管理、プロセスグループ、デーモン      |
| 05   | [scheduler](./05-scheduler.md)                   | スケジューリングポリシー、nice 値、CFS              |
| 06   | [namespace](./06-namespace.md)                   | namespace によるプロセス隔離（コンテナの基盤）      |
| 07   | [cgroup](./07-cgroup.md)                         | CPU・メモリ・I/O のリソース制限（コンテナの基盤）   |

---

## 前提知識

このリポジトリを始める前に、以下を完了していることを推奨します

- <strong>ユーザー空間の学習</strong>
  - プロセス、fork/exec、シグナル、スレッド、ファイルディスクリプタ、標準入出力、IPC の基本を理解していること
- <strong>C 言語の読み方</strong>
  - 前のシリーズの README.md で説明した「C 言語の読み方」を理解していること

---

## 前のシリーズとの関係

前のシリーズ（ユーザー空間）とこのリポジトリ（カーネル空間）は、以下の関係にあります

| 視点           | ユーザー空間                  | カーネル空間              |
| -------------- | ----------------------------- | ------------------------- |
| テーマ         | OS がプログラムを動かす仕組み | OS 自身がどう動いているか |
| 立場           | 使う側                        | 提供する側                |
| システムコール | 呼び出す                      | 受け取って処理する        |

同じ概念を両方のシリーズで扱う場合があります

| 概念     | ユーザー空間での扱い        | カーネル空間での扱い           |
| -------- | --------------------------- | ------------------------------ |
| プロセス | プロセスとは何か、fork/exec | カーネルがどう管理しているか   |
| メモリ   | malloc/free                 | 仮想メモリ、ページテーブル     |
| スレッド | pthread の使い方            | スケジューラがどう切り替えるか |
| シグナル | シグナルの送受信            | カーネルがどう配送しているか   |

---

## 参考資料

このリポジトリの内容は、以下のソースに基づいています

各トピックで使用する個別の man ページは、各トピックのドキュメントに記載しています

- [Linux man-pages](https://man7.org/linux/man-pages/)
  - Linux システムコールやライブラリ関数の公式マニュアル
- [The Linux Kernel documentation](https://www.kernel.org/doc/html/latest/)
  - Linux カーネルの公式ドキュメント
- [POSIX.1-2017](https://pubs.opengroup.org/onlinepubs/9699919799/)
  - UNIX 系 OS の標準仕様
